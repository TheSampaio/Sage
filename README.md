# Sage Programming Language

**Sage** is a statically typed, compiled programming language designed for high-performance applications and small-scale 2D games.
The compiler is implemented in **C# (.NET 8)** and operates as a full toolchain: it **transpiles** Sage source code (`.sg`) into optimized **C11** code and then orchestrates a native C compiler (GCC) to produce a standalone **Windows Executable (`.exe`)**.

The project strictly follows **SOLID principles** and **Clean Code** architecture, utilizing the **Visitor Pattern** for AST traversal, semantic analysis, and code generation.

## Core Features

* **Battery Included:** Handles the entire build process from source to binary (`.exe`).
* **Standard Project Layout:** Enforces a clean `src`, `obj`, and `bin` directory structure.
* **Modern Systems Syntax:** Familiar C-style logic with modern touches like explicit modules and `var` declarations.
* **Strong Typing & Casting:** Support for explicit types (`i32`, `f64`, `str`, `b8`) and explicit type conversion using the `as` keyword.
* **Modularity:** Code organization via `module` blocks and namespaced calls (`math::sum`).
* **Developer Tooling:** Standardized **JSON** debug outputs for Tokens (`.tok.json`) and Abstract Syntax Trees (`.ast.json`) for easy integration with external tools.

## Dependencies

Sage relies on an external C toolchain to finalize the build process.

* **GCC (GNU Compiler Collection):** **Required**
* **Installation:** Ensure you have **MinGW-w64** (or similar) installed and added to your system's `PATH`.
* **Verification:** Run `gcc --version` in your terminal to ensure the compiler is accessible.

## Compiler Pipeline

1. **Lexer:** Converts source code into a stream of strictly typed `Tokens`.
2. **Parser:** Builds a hierarchical **Abstract Syntax Tree (AST)**.
3. **Semantic Analyzer:** Manages scopes via `SymbolTable`, validates variable existence, and performs **Type Checking**.
4. **Code Generator:** Traverses the AST to emit optimized C11 code.
5. **Native Toolchain:** Invokes GCC to compile the intermediate C code into a final binary.

## Project Structure

```text
MyProject/
 |-- bin/
 |   |-- main.exe       (Final Application)
 |-- obj/
 |   |-- main.sg.c      (Transpiled C code)
 |   |-- main.sg.tok.json  (Debug tokens - JSON format)
 |   |-- main.sg.ast.json  (Debug tree - JSON format)
 |-- src/
 |   |-- main.sg        (Source code)

```

## Syntax Example

The following example showcases variable declarations, namespaced calls, and the explicit casting system:

```rust
// src/main.sg
use console;

module math
{
    func sum(a: f64, b: f64): f64
    {
        return a + b;
    }
}

func main(): none
{
    // Explicit variable declarations
    var age: i32 = 25;
    var pi: f64 = 3.1415;
    
    // Explicit casting (f64 to i32)
    var rounded_pi: i32 = pi as i32;

    // String interpolation with expression support
    console::print_line("Original PI: {pi}");
    console::print_line("Truncated PI: {rounded_pi}");
    
    var result: f64 = math::sum(10.5, 20.0);
    console::print_line("Math Result: {result}");
}
```

## Generated C Output (Intermediate)

```c
/* --- Generated by Sage Compiler --- */
#include <stdio.h>
#include <stdint.h>
#include <stdbool.h>
#include <uchar.h>

/* --- Sage Type Definitions --- */
typedef int8_t i8;
typedef int16_t i16;
typedef int32_t i32;
typedef int64_t i64;
typedef uint8_t u8;
typedef uint16_t u16;
typedef uint32_t u32;
typedef uint64_t u64;
typedef float f32;
typedef double f64;
typedef bool b8;
typedef char c8;
typedef char16_t c16;
typedef char32_t c32;
typedef char* str;
typedef void none;

/* --- Generated Logic --- */
// use console;
// Module: math
f64 math_sum(f64 a, f64 b)
{
    return (a + b);
}
none main()
{
    i32 age = 25;
    f64 pi = 3.1415;
    i32 rounded_pi = (i32)pi;
    printf("Original PI: %g\n", (double)(pi));
    printf("Truncated PI: %g\n", (double)(rounded_pi));
    f64 result = math_sum(10.5, 20.0);
    printf("Math Result: %g\n", (double)(result));
}
```

## Project Status

The project is in **Alpha**.

* [x] Variable Declarations (`var`) & Type Promotion
* [x] Explicit Casting (`as`)
* [x] Function Declarations & Return Types
* [x] Modules & Namespaces (`::`)
* [x] String Interpolation (compiled to `printf`)
* [x] **JSON Debug Tooling** (Tokens and AST)
* [x] Native Compilation (GCC Integration)

## License

This project is licensed under the **MIT License**.

© 2026 Kellvyn Sampaio — Sage Language Project