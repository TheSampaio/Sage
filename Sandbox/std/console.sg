/// Standard Library: Console
/// Provides high-level abstractions for terminal I/O,
/// screen manipulation, and system commands.
module console
{
    // --- Native C Bindings (Private to this module) ---

    extern libc_stdio("stdio.h")
    {
        func printf(format: str, arg: str): i32;
        func scanf(format: str, buffer: str): i32;
        func getchar(): i32;
    }

    extern libc_stdlib("stdlib.h")
    {
        func system(command: str): i32;
    }

    // --- High-Level API ---

    /// Clears the terminal screen and resets cursor position to (0,0).
    /// Uses ANSI escape sequences for cross-platform compatibility.
    func clear(): none
    {
        libc_stdio::printf("\x1B[2J\x1B[H", "");
    }

    /// Sets the cursor position on the terminal grid.
    /// NOTE: This is a placeholder until variadic support exists.
    func position(x: i32, y: i32): none
    {
        // Proper variadic binding required to fully support this
        libc_stdio::printf("\x1B[%d;%dH", "");
    }

    /// Writes the provided text to the standard output.
    func print(text: str): none
    {
        libc_stdio::printf("%s", text);
    }

    /// Writes text to the standard output followed by a newline character.
    func print_line(text: str): none
    {
        libc_stdio::printf("%s\n", text);
    }

    /// Sets the physical dimensions of the console window.
    /// Current implementation is Windows-specific.
    func size(cols: i32, lines: i32): none
    {
        // NOTE: Hardcoded values ï¿½ needs formatting support
        libc_stdlib::system("mode con: cols=80 lines=25");
    }

    /// Captures a single character input from the user.
    /// Returns the ASCII/Integer value of the key pressed.
    func read(): i32
    {
        return libc_stdio::getchar();
    }

    /// Reads a string from standard input into the provided buffer.
    func read_line(buffer: str): none
    {
        libc_stdio::scanf("%s", buffer);
    }
}
